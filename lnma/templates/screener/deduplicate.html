{% extends '_layout_adminlte.html' %}

{% block title %}
Deduplicate
{% endblock %}

{% block style %}
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css">

<style>
/* shared rules */
{% include 'css/pan_paperviewer.css' %}

/* local rules */
html {
    overflow-x: hidden;
    overflow-y: hidden;
}
#main {
    display: flex;
    flex-direction: row;
    width: 100%;
    height: 100%;
    margin: 0 0 0 10px;
    overflow: hidden;
}
.col-cq-name {
    max-width: 150px;
    text-align: center;
}
.col-ss-cq {
    text-align: center;
}

.table-ss-cq tr:hover {
    background-color: #efefef;
}
.table-ss-cq tbody {
    overflow-y: auto;
}
#pan_ocpapers_paperlist {
    overflow-x: hidden;
    height: 300px;
    font-size: 0.9em;
    max-width: calc(100% - 15px);
}
#pan_ocpapers_paperlist thead th{
    position: sticky;
    top: 0;
    background-color: #d8d8d8;
    padding: 0px 3px;
    vertical-align: bottom;
}
#pan_ocpapers_paperlist tbody{
    overflow-y: auto;
}
#pan_ocpapers_paperlist tbody td{
    padding: 0px 3px;
    border-right: 1px dotted #cfcfcf;
    border-bottom: 1px dotted #cfcfcf;
    vertical-align: middle;
}
#pan_ocpapers_paperlist tbody td input.check{
    zoom: 1.5;
}
</style>
{% endblock %}

{% block page_name %}
<i class="fa fa-braille"></i>
Deduplicate
{% endblock %}

{% block content %}

<div id="main">

<div id="app">

</div>

</div>

{% endblock %}

{% block active_nav_link %}screener-deduplicate{% endblock %}

{% block script %}
<script src="https://unpkg.com/dayjs@1.8.21/dayjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.4.0/clipboard.min.js" integrity="sha512-iJh0F10blr9SC3d0Ow1ZKHi9kt12NYa+ISlmCdlCdNZzFwjH1JppRTeAnypvUez01HroZhAmP4ro4AvZ/rG0UQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!-- my scripts -->
<script>

///////////////////////////////////////////////////////////
// bind the project information to srv_screener.js
///////////////////////////////////////////////////////////
{% include 'js/srv_screener.js' %}
srv_screener.project = [[ project_json_str|safe ]];

var app = {
    vpp_id: "#app",
    vpp: null,
    vpp_data: {
        keywords: '',
        project: [[ project_json_str|safe ]],

        papers: null
    },
    
    vpp_methods: {
    },

    init: function() {
        this.vpp = new Vue({
            el: this.vpp_id,
            data: this.vpp_data,
            methods: this.vpp_methods,
        });

        this.resize();
    },

    load: function() {
        var stage = srv_screener.STAGE_INCLUDED_SR;
        srv_screener.get_papers_by_stage(
            stage,
            '',
            '',
            function(data) {
                console.log(data);
                jarvis.toast('Loaded papers');

                // bind papers
                pan_ocpapers.vpp.$data.papers = data.papers;
            }
        );
    },

    resize: function() {
        var h = $(window).height() - 90;
        $('#pan_ocpapers_paperlist').height(h);
    }
};

var jarvis = {

    project: [[ project_json_str|safe ]],

    init: function () {
        // init the UI
        pan_ocpapers.init();

        // the load the papers
        pan_ocpapers.load();

        // bind resize event
        this.bind_resize_event();
    },

    toast: function(msg, type) {
        toast(msg, type);
    },

    prompt: function(text, value) {
        return window.prompt(text, value);
    },

    confirm: function(text) {
        return window.confirm(text);
    },

    bind_resize_event: function() {
        $(window).on('resize', function(){
            pan_ocpapers.resize();
        });
    }
};

$(document).ready(function () {
    jarvis.init();
})
</script>
{% endblock %}