<div id="pan_ocpapers" 
    class="panel-container" 
    style="height: 100%; overflow-y: auto;"
    v-if="extract != null">
    <div class="panel-info">
        <div class="oc-attr d-flex flex-row">
            <span style="font-size: 1.2em;" class="mr-2">
                <b>[{{ extract.meta.full_name }}]</b> Settings
            </span>

            <div class="btn-group mr-2" role="group" aria-label="Extract information">
                <button v-on:click="update_extract();"
                    class="btn btn-default btn-sm">
                    <i class="fa fa-save"></i>
                    Save all settings
                </button>
            </div>

            <div class="btn-group mr-2" role="group" aria-label="Extract information">
                <button v-on:click="goto_extract_data(extract)"
                    type="button" class="btn btn-default btn-sm">
                    <i class="fa fa-edit"></i>
                    Extract data
                </button>
            </div>

            <div class="btn-group mr-2" role="group" aria-label="Analyze outcome">
                <button v-on:click="goto_analysis(extract)"
                    type="button" class="btn btn-default btn-sm">
                    <i class="fa fa-chart-bar"></i>
                    Analyze this outcome
                </button>
            </div>

        </div>

    </div>

    <div v-bind:class="{hide: !show_settings}">

        <div class="card border-dark mt-2 mb-2 ml-2 mr-2" >
            
            <div class="card-body text-dark">
                <h5 class="card-title">Basic Settings</h5>

                <p class="card-text">The basic settings for this outcome.</p>


                <div class="row">
                    <div class="form-group col-md-4">
                        <label for="input_full_name">Outcome Full Name</label>
                        <input v-model="extract.meta.full_name"
                            class="form-control" 
                            id="input_full_name" aria-describedby="input_full_name_help">
                        <small id="input_full_name_help" class="form-text text-muted">
                            The full name of this outcome, such as <i>Overall Survival</i>, <i>Cough</i>.
                        </small>
                    </div>

                    <div class="form-group col-md-4">
                        <label for="input_analysis_group">Analysis Group</label>

                        <select v-model="extract.meta.group"
                            class="form-control" id="input_analysis_group">
                            <option value="primary">Primary Analysis</option>
                            <option value="sensitivity">Sensitivity Analysis</option>
                        </select>

                        <small id="input_analysis_group_help" class="form-text text-muted">
                            The group for this outcome, <i>Primary Analysis</i>, <i>Sensitivity Analysis,</i> or other?
                        </small>
                    </div>

                    <div class="form-group col-md-4">
                        <label for="input_category">Outcome Category</label>
                        <input v-model="extract.meta.category"
                            class="form-control" 
                            id="input_category" aria-describedby="input_category_help">
                        <small id="input_category_help" class="form-text text-muted">
                            The category of this outcome.
                        </small>
                    </div>

                </div>


            </div>

        </div>

        <!-- /card for the basic information -->


        <div class="card border-dark mt-2 mb-2 ml-2 mr-2">
            
            <div class="card-body text-dark">
                <h5 class="card-title">Public Website Appearance Settings</h5>

                <p class="card-text">The following settings will be used to decide what and how to display the information of this outcome in the public website.</p>


                <div class="row">
                    
                    <div class="form-group col-md-4">
                        <label for="input_included_in_plots">Include in PWMA Plots</label>

                        <select v-model="extract.meta.included_in_plots"
                            class="form-control" id="input_included_in_plots" 
                            aria-describedby="input_included_in_plots_help">
                            <option value="yes">Yes, include this outcome</option>
                            <option value="no">No, exclude this outcome</option>
                        </select>

                        <small id="input_included_in_plots_help" class="form-text text-muted">
                            Include this outcome in the PWMA result plots or not?
                        </small>
                    </div>

                    <div class="form-group col-md-4">
                        <label for="input_included_in_sof">Include in SoF Table</label>

                        <select v-model="extract.meta.included_in_sof"
                            class="form-control" id="input_included_in_sof" 
                            aria-describedby="input_included_in_sof_help">
                            <option value="yes">Yes, include this outcome</option>
                            <option value="no">No, exclude this outcome</option>
                        </select>

                        <small id="input_included_in_sof_help" class="form-text text-muted">
                            Include this outcome in the SoF table or not?
                        </small>
                    </div>

                    <div class="form-group col-md-4">
                        <label for="input_input_format">Data Type / Input Format</label>

                        <select v-model="extract.meta.input_format"
                            v-on:change="on_change_input_format($event)"
                            class="form-control" id="input_input_format" 
                            aria-describedby="input_input_format_help">
                            <option value="PRIM_CAT_PRE">Categorical Precalculated Data</option>
                            <option value="PRIM_CAT_RAW">Categorical Raw Data</option>
                            <option value="PRIM_CATIRR_RAW">Categorical Raw (Incidence Rate Ratios) Data</option>
                            <option value="PRIM_CONTD_PRE">Continuous Precalculated Data</option>
                            <option value="PRIM_CONTD_RAW">Continuous Raw Data</option>
                            <option value="PRIM_CAT_RAW_G5">Categorical Raw Data of Grades (for IO project use only)</option>
                        </select>

                        <small id="input_input_format_help" class="form-text text-muted">
                            The format of the input data to the analyzer.
                        </small>
                    </div>

                </div>
                <!-- /.row -->

                <p>
                    The following settings are used for running the analyzer for SoF and plots
                </p>

                <div class="row">

                    <div class="form-group col-md-4">
                        <label for="input_measure_of_effect">Measure of Effects</label>

                        <select v-model="extract.meta.measure_of_effect"
                            class="form-control" id="input_measure_of_effect" 
                            aria-describedby="input_measure_of_effect_help">
                            <option value="HR">Hazard Ratio (HR)</option>
                            <option value="RR">Relative Risk (RR)</option>
                            <option value="OR">Odds Ratio (OR)</option>
                            <option value="RD">Risk Difference (RD)</option>
                        </select>

                        <small id="input_measure_of_effect_help" class="form-text text-muted">
                            The measure of effects
                        </small>
                    </div>


                    <div class="form-group col-md-4">
                        <label for="input_measure_of_effect">Fixed or Random</label>

                        <select v-model="extract.meta.measure_of_effect"
                            class="form-control" id="input_measure_of_effect" 
                            aria-describedby="input_measure_of_effect_help">
                            <option value="HR">Hazard Ratio (HR)</option>
                            <option value="RR">Relative Risk (RR)</option>
                            <option value="OR">Odds Ratio (OR)</option>
                            <option value="RD">Risk Difference (RD)</option>
                        </select>

                        <small id="input_measure_of_effect_help" class="form-text text-muted">
                            The measure of effects
                        </small>
                    </div>

                    <div class="form-group col-md-4">
                        <label for="input_which_is_better">Which is better</label>

                        <select v-model="extract.meta.which_is_better"
                            class="form-control" id="input_which_is_better" 
                            aria-describedby="input_which_is_better_help">
                            <option value="lower">Lower is better</option>
                            <option value="higher">Higher is better</option>
                        </select>

                        <small id="input_which_is_better_help" class="form-text text-muted">
                            Which is better when comparing the measure of effects.
                        </small>
                    </div>
                    
                </div>


            </div>

        </div>

        <!-- /card for the inclusion or not -->


    </div>
    <!-- /div of settings -->


    <div class="card border-dark mt-2 mb-2 ml-2 mr-2">
            
        <div class="card-body text-dark">
            <h5 class="card-title">
                References Settings
            
               <span class="text-sm ml-3">
                    <input type="checkbox"
                        v-model="only_show_selected"
                        v-on:change="on_change_only_show_selected($event);">
                    <span>Only show selected studies</span>
               </span>
            </h5>

            <p class="card-text mb-2">Select the papers included in this outcome for the public website.</p>

            <div class="panel-paperlist" v-if="extract != null">

                <!-- table for pwma -->
                <table class="table" style="table-layout:auto;">
                    <thead class="paper-table-header">
                        <tr>
                            <th class="paper-table-header-th" colspan="4">
                                &nbsp;
                            </th>
                            <th v-for="thr1 in thr1s"
                                v-bind:colspan="thr1.cols"
                                class="paper-table-header-th"
                                style="text-align: center;">
                                {{ thr1.name }}
                            </th>
                        </tr>
                        <tr>
                            <th class="paper-table-header-th" style="width: 20px;">
                                In
                            </th>
                            <th class="paper-table-header-th" style="width: 40px;">
                                #
                            </th>
                            <th class="paper-table-header-th" style="width: 90px;" v-show="show_col_nct">
                                NCT
                            </th>
                            <th class="paper-table-header-th" style="width: 190px;">
                                ({{ n_selected }} selected)
                            </th>
                            <th class="paper-table-header-th" style="width: 50px;">
                                Arms
                            </th>

                            <!-- the attributes of pwma -->
                            <th class="paper-table-header-th" 
                                v-for="thr2 in thr2s"
                                v-bind:colspan="thr2.cols"
                                style="text-align: center;">
                                <span>
                                    {{ thr2.name }}
                                </span>
                            </th>
                        </tr>
                    </thead>
        
                    <tbody>
                        <tr class="paper-table-row" 
                            v-for="paper in papers"
                            v-bind:id="'paper-table-row-' + paper.pid"
                            v-show="!only_show_selected || extract.data[paper.pid].is_selected">
                            <td class="paper-table-body-td">
                                <input type="checkbox" id="" v-model="extract.data[paper.pid].is_selected" >
                            </td>
                            <td class="paper-table-body-td">
                                <span class="badge badge-pill badge-light">{{ paper.seq_num }}</span> 
                            </td>

                            <td class="paper-table-body-td"
                                v-show="show_col_nct">
                                <span class="text-sm">{{ paper.meta.rct_id }}</span>
                            </td>

                            <td class="paper-table-body-td ">
                                <div class="paper-table-body-td-author"
                                    v-bind:title="get_first_author(paper.authors)">
                                    {{ get_first_author(paper.authors) }} {{ get_year(paper.pub_date) }}
                                </div>
                            </td>
                            
                            <td class="paper-table-body-td">
                                {{ extract.data[paper.pid].n_arms }}
                            </td>
                            
                            <!-- the attributes of pwma -->
                            <td v-for="attr_sub in all_attrs" 
                                class="paper-table-body-td paper-value">
                                
                                <!-- the main track -->
                                <span class="paper-table-body-cell"
                                    v-bind:title="extract.data[paper.pid].attrs.main[attr_sub.abbr]">
                                    {{ extract.data[paper.pid].attrs.main[attr_sub.abbr] }}&nbsp;
                                </span>
        
                                <!-- the other tracks if n_arms > 2 -->
                                <hr class="n-arms-hr" v-if="extract.data[paper.pid].n_arms > 2">
        
                                <span v-for="other, other_idx in extract.data[paper.pid].attrs.other"
                                    class="paper-table-body-cell"
                                    v-bind:title="extract.data[paper.pid].attrs.other[other_idx][attr_sub.abbr]">
                                    <br v-if="other_idx > 0">
                                    {{ extract.data[paper.pid].attrs.other[other_idx][attr_sub.abbr] }}&nbsp;
                                </span>                        
        
                            </td>
                        </tr>
                    </tbody>
                </table>
        
        
            </div>
            <!-- /.panel-paperlist -->

        </div>
    </div>

</div>
<!-- /#pan_ocpapers -->